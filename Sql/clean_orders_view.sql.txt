#10. Create a view clean_orders where discount_pct < 0 is treated as 0 and discount_pct > 80 i


DROP VIEW IF EXISTS clean_orders;

CREATE VIEW clean_orders AS
SELECT
    order_id,
    customer_id,
    STR_TO_DATE(order_date, '%Y-%m-%d') AS cleaned_order_date,
    CASE
        WHEN discount_pct < 0 THEN 0
        WHEN discount_pct > 80 THEN 80
        ELSE discount_pct
    END AS clean_discount_pct,
    platform,
    category,
    quantity,
    unit_price,
    (quantity * unit_price) AS gross_amount,
    (quantity * unit_price) *
        (1 - (
            CASE
                WHEN discount_pct < 0 THEN 0
                WHEN discount_pct > 80 THEN 80
                ELSE discount_pct
            END
        ) / 100) AS net_amount
FROM ecommerce_orders_raw_table;

select * from clean_orders;

